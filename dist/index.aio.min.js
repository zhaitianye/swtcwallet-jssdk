!function(n,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e(n.swtcwallet={})}(this,function(n){"use strict";function e(n,e,t,r){return new(t||(t=Promise))(function(i,o){function c(n){try{s(r.next(n))}catch(n){o(n)}}function u(n){try{s(r.throw(n))}catch(n){o(n)}}function s(n){n.done?i(n.value):new t(function(e){e(n.value)}).then(c,u)}s((r=r.apply(n,e||[])).next())})}function t(n,e){function t(n){return function(e){return r([n,e])}}function r(t){if(i)throw new TypeError("Generator is already executing.");for(;s;)try{if(i=1,o&&(c=2&t[0]?o.return:t[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,t[1])).done)return c;switch(o=0,c&&(t=[2&t[0],c.value]),t[0]){case 0:case 1:c=t;break;case 4:return s.label++,{value:t[1],done:!1};case 5:s.label++,o=t[1],t=[0];continue;case 7:t=s.ops.pop(),s.trys.pop();continue;default:if(c=s.trys,!(c=c.length>0&&c[c.length-1])&&(6===t[0]||2===t[0])){s=0;continue}if(3===t[0]&&(!c||t[1]>c[0]&&t[1]<c[3])){s.label=t[1];break}if(6===t[0]&&s.label<c[1]){s.label=c[1],c=t;break}if(c&&s.label<c[2]){s.label=c[2],s.ops.push(t);break}c[2]&&s.ops.pop(),s.trys.pop();continue}t=e.call(n,s)}catch(n){t=[6,n],o=0}finally{i=c=0}if(5&t[0])throw t[1];return{value:t[0]?t[1]:void 0,done:!0}}var i,o,c,u,s={label:0,sent:function(){if(1&c[0])throw c[1];return c[1]},trys:[],ops:[]};return u={next:t(0),throw:t(1),return:t(2)},"function"==typeof Symbol&&(u[Symbol.iterator]=function(){return this}),u}function r(){return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,m()];case 1:return[2,n.sent()]}})})}function i(){return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("getAppInfo","",function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}function o(n){return e(this,void 0,void 0,function(){return t(this,function(e){switch(e.label){case 0:return[4,new Promise(function(e){y("toast",n,function(n){e(JSON.parse(n))})})];case 1:return[2,e.sent()]}})})}function c(){return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("invokeQRScanner","",function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}function u(){return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("back","",function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}function s(){return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("refresh","",function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}function a(){return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("close","",function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}function f(){return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("createWallet","",function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}function l(){return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("getCurrentWallet","",function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}function d(){return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("switchWallet","",function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}function h(){return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("selectNode","",function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}function v(n){var r=n.to,i=n.value,o=n.currency,c=n.issuer,u=n.memo;return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("sign",{to:r,value:i,currency:o,issuer:c,memo:u},function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}function p(n){var r=n.blob;return e(this,void 0,void 0,function(){return t(this,function(n){switch(n.label){case 0:return[4,new Promise(function(n){y("sendTransaction",{blob:r},function(e){n(JSON.parse(e))})})];case 1:return[2,n.sent()]}})})}var w=navigator.userAgent.indexOf("Android")>-1||navigator.userAgent.indexOf("Adr")>-1,b=!!navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),m=function(n){return void 0===n&&(n=1e3),e(this,void 0,void 0,function(){var e,r,i;return t(this,function(t){switch(t.label){case 0:return b?[2,{success:!1,msg:"IOS系统暂不支持",code:-1}]:b||w?(e=new Promise(function(n){window.WebViewJavascriptBridge&&n(!0),document.addEventListener("WebViewJavascriptBridgeReady",function(){n(!0)},!1)}),r=new Promise(function(e){setTimeout(function(){e(!1)},n)}),[4,new Promise(function(n){Promise.race([e,r]).then(function(e){!0===e?n(!0):(document.removeEventListener("WebViewJavascriptBridgeReady",function(){alert("removeEventListener")},!1),n(!1))})})]):[2,{success:!1,msg:"其他平台暂不支持",code:-1}];case 1:return i=t.sent(),!0===i?[2,{success:!0,msg:"成功",code:0}]:[2,{success:!1,msg:"未连接到SWTC钱包",code:-1}]}})})},y=function(n,e,t){m().then(function(r){if(!r.success)return void t(JSON.stringify(r));window.WebViewJavascriptBridge.callHandler(n,e,t)})};n.isConnected=r,n.appInfo=i,n.appToast=o,n.appQr=c,n.appBack=u,n.appRefresh=s,n.appClose=a,n.walletCreate=f,n.walletCurrent=l,n.walletSwitch=d,n.selectNode=h,n.txSign=v,n.txSend=p,Object.defineProperty(n,"__esModule",{value:!0})});
